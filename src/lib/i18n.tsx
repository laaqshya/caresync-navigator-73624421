import React, { createContext, useContext, useState, useCallback, type ReactNode } from 'react';

export type Language = 'en' | 'es' | 'fr';

const translations: Record<Language, Record<string, string>> = {
  en: {
    patients: 'Patients',
    activeWorkflow: 'Active Workflow',
    pendingActions: 'Pending Actions',
    delayedActions: 'Delayed Actions',
    doctors: 'Doctors',
    logout: 'Logout',
    search: 'Search...',
    patientId: 'Patient ID',
    name: 'Name',
    age: 'Age',
    gender: 'Gender',
    assignedDoctor: 'Assigned Doctor',
    currentStage: 'Current Stage',
    status: 'Status',
    lastUpdated: 'Last Updated',
    completed: 'Completed',
    inProgress: 'In Progress',
    pending: 'Pending',
    delayed: 'Delayed',
    totalActive: 'Total Active',
    completedToday: 'Completed Today',
    avgProcessingTime: 'Avg Processing Time',
    actionRequired: 'Action Required',
    responsibleRole: 'Responsible Role',
    timeSinceUpdate: 'Time Since Update',
    stageOfDelay: 'Stage of Delay',
    timeExceeded: 'Time Exceeded',
    responsibleDept: 'Responsible Dept',
    patientSummary: 'Patient Summary',
    timeline: 'Timeline',
    testsReports: 'Tests & Reports',
    testName: 'Test Name',
    orderedBy: 'Ordered By',
    resultStatus: 'Result Status',
    reportFile: 'Report File',
    view: 'View',
    specialization: 'Specialization',
    department: 'Department',
    activePatients: 'Active Patients',
    completedCases: 'Completed Cases',
    overview: 'Overview',
    assignedPatients: 'Assigned Patients',
    consultationDate: 'Consultation Date',
    testsOrdered: 'Tests Ordered',
    reportStatus: 'Report Status',
    prescriptionStatus: 'Prescription Status',
    workflowStage: 'Workflow Stage',
    voiceListening: 'Listening...',
    voiceReady: 'Voice Ready',
    progressTracker: 'Progress Tracker',
    filterByStatus: 'Filter by Status',
    all: 'All',
    admin: 'Admin',
    timeSpent: 'Time Spent',
    delayDetected: 'Delay Detected',
  },
  es: {
    patients: 'Pacientes',
    activeWorkflow: 'Flujo Activo',
    pendingActions: 'Acciones Pendientes',
    delayedActions: 'Acciones Retrasadas',
    doctors: 'Doctores',
    logout: 'Cerrar Sesión',
    search: 'Buscar...',
    patientId: 'ID Paciente',
    name: 'Nombre',
    age: 'Edad',
    gender: 'Género',
    assignedDoctor: 'Doctor Asignado',
    currentStage: 'Etapa Actual',
    status: 'Estado',
    lastUpdated: 'Última Actualización',
    completed: 'Completado',
    inProgress: 'En Progreso',
    pending: 'Pendiente',
    delayed: 'Retrasado',
    totalActive: 'Total Activos',
    completedToday: 'Completados Hoy',
    avgProcessingTime: 'Tiempo Promedio',
    actionRequired: 'Acción Requerida',
    responsibleRole: 'Rol Responsable',
    timeSinceUpdate: 'Tiempo desde Actualización',
    stageOfDelay: 'Etapa del Retraso',
    timeExceeded: 'Tiempo Excedido',
    responsibleDept: 'Dept. Responsable',
    patientSummary: 'Resumen del Paciente',
    timeline: 'Línea de Tiempo',
    testsReports: 'Pruebas e Informes',
    testName: 'Nombre del Test',
    orderedBy: 'Ordenado Por',
    resultStatus: 'Estado del Resultado',
    reportFile: 'Archivo de Informe',
    view: 'Ver',
    specialization: 'Especialización',
    department: 'Departamento',
    activePatients: 'Pacientes Activos',
    completedCases: 'Casos Completados',
    overview: 'Resumen',
    assignedPatients: 'Pacientes Asignados',
    consultationDate: 'Fecha de Consulta',
    testsOrdered: 'Pruebas Ordenadas',
    reportStatus: 'Estado del Informe',
    prescriptionStatus: 'Estado de Receta',
    workflowStage: 'Etapa del Flujo',
    voiceListening: 'Escuchando...',
    voiceReady: 'Voz Lista',
    progressTracker: 'Seguimiento de Progreso',
    filterByStatus: 'Filtrar por Estado',
    all: 'Todos',
    admin: 'Admin',
    timeSpent: 'Tiempo Empleado',
    delayDetected: 'Retraso Detectado',
  },
  fr: {
    patients: 'Patients',
    activeWorkflow: 'Flux Actif',
    pendingActions: 'Actions en Attente',
    delayedActions: 'Actions Retardées',
    doctors: 'Médecins',
    logout: 'Déconnexion',
    search: 'Rechercher...',
    patientId: 'ID Patient',
    name: 'Nom',
    age: 'Âge',
    gender: 'Genre',
    assignedDoctor: 'Médecin Assigné',
    currentStage: 'Étape Actuelle',
    status: 'Statut',
    lastUpdated: 'Dernière Mise à Jour',
    completed: 'Terminé',
    inProgress: 'En Cours',
    pending: 'En Attente',
    delayed: 'Retardé',
    totalActive: 'Total Actifs',
    completedToday: "Terminés Aujourd'hui",
    avgProcessingTime: 'Temps Moyen',
    actionRequired: 'Action Requise',
    responsibleRole: 'Rôle Responsable',
    timeSinceUpdate: 'Temps depuis MAJ',
    stageOfDelay: 'Étape du Retard',
    timeExceeded: 'Temps Dépassé',
    responsibleDept: 'Dept. Responsable',
    patientSummary: 'Résumé du Patient',
    timeline: 'Chronologie',
    testsReports: 'Tests et Rapports',
    testName: 'Nom du Test',
    orderedBy: 'Ordonné Par',
    resultStatus: 'Statut du Résultat',
    reportFile: 'Fichier de Rapport',
    view: 'Voir',
    specialization: 'Spécialisation',
    department: 'Département',
    activePatients: 'Patients Actifs',
    completedCases: 'Cas Terminés',
    overview: 'Aperçu',
    assignedPatients: 'Patients Assignés',
    consultationDate: 'Date de Consultation',
    testsOrdered: 'Tests Ordonnés',
    reportStatus: 'Statut du Rapport',
    prescriptionStatus: 'Statut Ordonnance',
    workflowStage: 'Étape du Flux',
    voiceListening: 'Écoute...',
    voiceReady: 'Voix Prête',
    progressTracker: 'Suivi de Progression',
    filterByStatus: 'Filtrer par Statut',
    all: 'Tous',
    admin: 'Admin',
    timeSpent: 'Temps Passé',
    delayDetected: 'Retard Détecté',
  },
};

interface I18nContextType {
  lang: Language;
  setLang: (lang: Language) => void;
  t: (key: string) => string;
}

const I18nContext = createContext<I18nContextType>({
  lang: 'en',
  setLang: () => {},
  t: (key) => key,
});

export function I18nProvider({ children }: { children: ReactNode }) {
  const [lang, setLang] = useState<Language>('en');
  const t = useCallback((key: string) => translations[lang]?.[key] || key, [lang]);

  return (
    <I18nContext.Provider value={{ lang, setLang, t }}>
      {children}
    </I18nContext.Provider>
  );
}

export function useI18n() {
  return useContext(I18nContext);
}
